!function(t){function e(){var e=t("#pum-shortcode-editor-pum_sub_form #provider"),o=""!==e.val()&&"none"!==e.val()?e.val():pum_admin_vars.default_provider,n=t('.pum-modal-content .tabs .tab a[href^="#pum-shortcode-editor-pum_sub_form_provider_"]'),i=t('[id^="pum-shortcode-editor-pum_sub_form_provider_"]'),r=n.filter('[href="#pum-shortcode-editor-pum_sub_form_provider_'+o+'"]'),s=i.filter('[id="pum-shortcode-editor-pum_sub_form_provider_'+o+'"]');n.each(function(){t(this).parent().hide()}),i.find(":input").attr("disable",!0),r.length&&(r.parent().show(),s.find(":input").attr("disable",!1))}function o(){var e=t("#pum-shortcode-editor-pum_sub_form_provider_mailchimp #list_id"),o=e.val(),n=t("#pum-mci-list-"+o+",.pum-mci-list-"+o),i=t(".pum-mci-list-options");i.hide(),i.find('input[type="checkbox"]').attr("disabled",!0),n.length&&(n.show(),n.find('input[type="checkbox"]').attr("disabled",!1))}"undefined"==typeof window.pum_newsletter_initialized&&(window.pum_newsletter_initialized=!0,t(document).on("pum_init","#pum-shortcode-editor-pum_sub_form",e).on("change","#pum-shortcode-editor-pum_sub_form #provider",e),t(document).on("pumInit pum_init","#pum-shortcode-editor-pum_sub_form",o).on("change","#pum-shortcode-editor-pum_sub_form_provider_mailchimp #list_id",o))}(jQuery),function(t){"use strict";if(void 0!==window.pum_shortcode_ui_vars){var e=pum_shortcode_ui_vars.I10n||{error_loading_shortcode_preview:"",shortcode_ui_button_tooltip:"",insert:"",update:""},o=pum_shortcode_ui_vars.shortcodes||{},n={version:1,shortcode_args:{},shortcode_data:{},initialize:function(t){},cleanAttrs:function(t){return _.each(t,function(e,o){null!==e&&""!==e||delete t[o],"object"==typeof e&&(t[o]=Object.keys(e))}),t},template:function(e){var o,n="pum-shortcode-view-"+this.type,i={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"attrs"};return 1===this.version&&(i.variable="attr"),t("#tmpl-"+n).length?(o=_.template(t("#tmpl-"+n).html(),i),e["class"]&&(e.classes=e["class"],delete e["class"]),e=this.cleanAttrs(e),o(e)):this.text},getShortcodeValues:function(){if("undefined"==typeof this.shortcode||"undefined"==typeof this.shortcode.attrs)return{};var t={};if("undefined"!=typeof this.shortcode.attrs.named&&(t=_.extend(t,this.shortcode.attrs.named||{})),"undefined"!=typeof this.shortcode.attrs.numeric)for(var e=0;e<this.shortcode.attrs.numeric.length;e++)t[this.shortcode.attrs.numeric[e]]=!0;return t},getShortcodeContent:function(){return"undefined"==typeof this.shortcode?"":this.shortcode.content||""},getContent:function(){return this.content||this.fetch(),this.content},formatShortcode:function(t){var e=this.shortcode_args.has_content,o=this.getShortcodeContent();return t=t||this.getShortcodeValues(),e&&"undefined"!=typeof t._inner_content&&(o=t._inner_content,delete t._inner_content),t=this.cleanAttrs(t),PUM_Admin.templates.shortcode({tag:this.type,meta:t,has_content:e,content:o})},fetch:function(){var o=this,n=o.getShortcodeValues(),i={action:"pum_do_shortcode",post_id:t("#post_ID").val(),tag:o.type,shortcode:o.formatShortcode(),nonce:pum_shortcode_ui_vars.nonce};o.fetching||(o.fetching=!0,o.shortcode_args.has_content&&(n._inner_content=o.getShortcodeContent()),o.shortcode_args.ajax_rendering?t.post(ajaxurl,i).done(function(t){o.content=t.data}).fail(function(){o.content='<span class="pum_shortcode_ui_vars_error">'+e.error_loading_shortcode_preview+"</span>"}).always(function(){delete o.fetching,o.render()}):(o.content=o.template(n),delete o.fetching,o.render()))},edit:function(t,e){var o=_.extend({},this.getShortcodeValues());this.shortcode_args.has_content&&(o._inner_content=this.getShortcodeContent()),this.renderForm(o,e)},setLoader:function(){this.setContent('<div class="loading-placeholder"><div class="dashicons dashicons-admin-generic"></div><div class="wpview-loading"><ins></ins></div></div>')},renderForm:function(o,n){var i=this,r=t.extend(!0,{},{tag:this.type,id:"pum-shortcode-editor-"+this.type,label:"",tabs:{},sections:{},fields:{}},i.shortcode_args);o=o||{},PUM_Admin.modals.reload("#"+r.id,PUM_Admin.templates.modal({id:r.id,title:r.label,description:r.description,classes:"tabbed-content pum-shortcode-editor",save_button:void 0===o?e.insert:e.update,content:PUM_Admin.forms.render({id:"pum-shortcode-editor-"+this.type,tabs:r.tabs||{},sections:r.sections||{},fields:r.fields||{}},o||{}),meta:{"data-shortcode_tag":this.type}})),t("#"+r.id+" form").on("submit",function(e){e.preventDefault();var o,s=t(this),d=PUM_Admin.forms.parseValues(s.pumSerializeObject().attrs,PUM_Admin.forms.flattenFields(r));o=i.formatShortcode(d),"function"==typeof n&&n(o),PUM_Admin.modals.closeAll()})}};t(document).on("pumFormDependencyMet pumFormDependencyUnmet",".pum-shortcode-editor .pum-field",function(e){var o=t(this).find(":input");"pumFormDependencyUnmet"===e.type.toString()?o.prop("disabled",!0):o.prop("disabled",!1)}).ready(function(){window.wp=window.wp||{},window.wp.mce=window.wp.mce||{},window.wp.mce.pum_shortcodes=window.wp.mce.pum_shortcodes||{},_.each(o,function(e,o){wp.mce.pum_shortcodes[o]=_.extend({},n,{version:e.version||1,shortcode_args:e,View:{type:o,template:function(t){return wp.mce.pum_shortcodes[this.type].template(t)},postID:t("#post_ID").val(),initialize:function(t){this.shortcode=t.shortcode,wp.mce.pum_shortcodes[this.type].shortcode_data=this.shortcode},getHtml:function(){var t=this.shortcode.attrs.named;return this.shortcode_args.has_content&&(t._inner_content=this.shortcode.content),this.template(t)}}}),"undefined"!=typeof wp.mce.views&&"function"==typeof wp.mce.views.register&&wp.mce.views.register(o,wp.mce.pum_shortcodes[o])})})}}(jQuery);