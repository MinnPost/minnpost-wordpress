"use strict";var __=wp.i18n.__,_n=wp.i18n._n,sce_hooks=wp.hooks.createHooks();jQuery(document).ready(function(a){var b=a.simplecommentediting=a.fn.simplecommentediting=function(){this;return this.each(function(){function c(b,c){a(b).siblings(".sce-textarea").off(),a(b).off(),a(b).parent().remove(),a.post(d,{action:"sce_delete_comment",comment_id:c.cid,post_id:c.pid,nonce:c._wpnonce},function(d){d.errors?(alert(simple_comment_editing.comment_deleted_error),a(b).siblings(".sce-textarea").on(),a(b).on()):(a("#sce-edit-comment-status"+c.cid).removeClass().addClass("sce-status updated").html(simple_comment_editing.comment_deleted).show(),setTimeout(function(){a("#comment-"+c.cid).slideUp()},3e3))},"json")}var d=a(this).find("a:first").attr("href"),f=wpAjax.unserialize(d),g=this;a(g).on("click","a:first",function(b){b.preventDefault(),a("#sce-edit-comment-status"+f.cid).removeClass().addClass("sce-status").css("display","none"),a(g).fadeOut("fast",function(){a(g).siblings(".sce-textarea").find("button").prop("disabled",!1),a(g).siblings(".sce-textarea").fadeIn("fast",function(){var b=a(g).siblings(".sce-textarea").find("textarea:first");jQuery("body").triggerHandler("sce.edit.show",[b,f.cid]),b.focus()})})}),a(g).siblings(".sce-textarea").on("click",".sce-comment-cancel",function(c){c.preventDefault(),a(g).siblings(".sce-textarea").fadeOut("fast",function(){a(g).fadeIn("fast"),a("#sce-edit-comment"+f.cid+" textarea").val(b.textareas[f.cid])})});a(g).siblings(".sce-textarea").on("click",".sce-comment-delete",function(a){a.preventDefault(),simple_comment_editing.allow_delete_confirmation?confirm(simple_comment_editing.confirm_delete)&&c(g,f):c(g,f)}),a(g).siblings(".sce-textarea").on("click",".sce-comment-save",function(h){h.preventDefault(),a(g).siblings(".sce-textarea").find("button").prop("disabled",!0),a(g).siblings(".sce-textarea").fadeOut("fast",function(){a(g).siblings(".sce-loading").fadeIn("fast");var e=a(g).siblings(".sce-textarea").find("textarea").val(),h=a.trim(e);if(""==h&&!0==simple_comment_editing.allow_delete)return confirm(simple_comment_editing.empty_comment)?void c(g,f):(a("#sce-edit-comment"+f.cid+" textarea").val(b.textareas[f.cid]),void a(g).siblings(".sce-loading").fadeOut("fast",function(){a(g).fadeIn("fast")}));jQuery("body").triggerHandler("sce.comment.save.pre",[f.cid,f.pid]);var i={action:"sce_save_comment",comment_content:h,comment_id:f.cid,post_id:f.pid,nonce:f._wpnonce};i=sce_hooks.applyFilters("sce.comment.save.data",i),a.post(d,i,function(c){a(g).siblings(".sce-loading").fadeOut("fast",function(){a(g).fadeIn("fast",function(){c.errors?(!0==c.remove&&(a(g).siblings(".sce-textarea").off(),a(g).off(),a(g).parent().remove()),a("#sce-edit-comment-status"+f.cid).removeClass().addClass("sce-status error").html(c.error).show()):(a("#sce-comment"+f.cid).html(c.comment_text),b.textareas[f.cid]=a("#sce-edit-comment"+f.cid+" textarea").val(),jQuery("body").triggerHandler("sce.comment.save",[f.cid,f.pid]))})})},"json")})}),a.post(d,{action:"sce_get_time_left",comment_id:f.cid,post_id:f.pid,_ajax_nonce:simple_comment_editing.nonce},function(c){if("unlimited"===c.minutes&&"unlimited"===c.seconds)return void a(g).show(400);var d=parseInt(c.minutes),e=parseInt(c.seconds),f=b.get_timer_text(d,e),h=c.can_edit;return h?void(a(g).find(".sce-timer").html(f),a(g).siblings(".sce-textarea").find(".sce-timer").html(f),a(g).show(400,function(){a(g).trigger("sce.timer.loaded",g),console.log(g)}),b.textareas[c.comment_id]=a("#sce-edit-comment"+c.comment_id+" textarea").val(),b.timers[c.comment_id]={minutes:d,seconds:e,start:new Date().getTime(),time:0,timer:function(){var d=b.timers[c.comment_id].seconds-1,e=b.timers[c.comment_id].minutes;if(0>=e&&0>=d)return a(g).siblings(".sce-textarea").off(),a(g).off(),void a(g).parent().remove();0>d&&(e-=1,d=59);var f=b.get_timer_text(e,d);a(g).find(".sce-timer").html(f),a(g).siblings(".sce-textarea").find(".sce-timer").html(f),a(g).trigger("sce.timer.countdown",g),b.timers[c.comment_id].seconds=d,b.timers[c.comment_id].minutes=e;var h=b.timers[c.comment_id];h.time+=1e3;var i=new Date().getTime()-h.start-h.time;window.setTimeout(h.timer,1e3-i)}},window.setTimeout(b.timers[c.comment_id].timer,1e3)):(a(g).siblings(".sce-textarea").off(),a(g).off(),void a(g).parent().remove())},"json")})};b.get_timer_text=function(a,b){var c=Math.floor;0>b&&(a-=1,b=59);var d="";if(1<=a){var e=Math.abs(60*a),f=c(e/86400);0<f&&(d+=f+" "+_n("day","days",f,"simple-comment-editing"),d+=" "+__("and","simple-comment-editing")+" ",e-=86400*f);var g=c(e/3600)%24;0<=g&&(0<g&&(d+=g+" "+_n("hour","hours",g,"simple-comment-editing"),d+=" "+__("and","simple-comment-editing")+" "),e-=3600*g);var a=c(e/60)%60;e-=a,0<a&&(d+=a+" "+_n("minute","minutes",a,"simple-comment-editing")),0<b&&(d+=" "+__("and","simple-comment-editing")+" ",d+=b+" "+_n("second","seconds",b,"simple-comment-editing"))}else d+=b+" "+_n("second","seconds",b,"simple-comment-editing");return d=sce_hooks.applyFilters("sce.comment.timer.text",d,_n("day","days",f,"simple-comment-editing"),_n("hour","hours",g,"simple-comment-editing"),_n("minute","minutes",a,"simple-comment-editing"),_n("second","seconds",b,"simple-comment-editing"),f,g,a,b),d},b.set_comment_cookie=function(b,c,d){a.post(simple_comment_editing.ajax_url,{action:"sce_get_cookie_var",post_id:b,comment_id:c,_ajax_nonce:simple_comment_editing.nonce},function(a){var b=new Date(a.expires);b=b.toGMTString(),document.cookie=a.name+"="+a.value+"; expires="+b+"; path="+a.path,"function"==typeof d&&d(c)},"json")},b.timers=[],b.textareas=[],a(".sce-edit-button").simplecommentediting(),a(".sce-edit-button").on("sce.timer.loaded",SCE_comment_scroll),a("body").on("comment.posted",function(c,d,e){b.set_comment_cookie(d,e,function(b){a.post(simple_comment_editing.ajax_url,{action:"sce_get_comment",comment_id:b,_ajax_nonce:simple_comment_editing.nonce},function(b){a("body").trigger("sce.comment.loaded",[b])},"json")})}),a("body").on("epoch.comment.posted",function(c,d,e){"undefined"==typeof d||b.set_comment_cookie(d,e,function(b){a.post(simple_comment_editing.ajax_url,{action:"sce_epoch_get_comment",comment_id:b,_ajax_nonce:simple_comment_editing.nonce},function(c){comment=Epoch.parse_comment(c),a("#comment-"+b).replaceWith(comment),a("#comment-"+b).find(".sce-edit-button").simplecommentediting()},"json")})}),a("body").on("epoch.comments.loaded, epoch.two.comments.loaded",function(){setTimeout(function(){a(".sce-edit-button").simplecommentediting()},1e3)}),a("body").on("epoch.two.comment.posted",function(c){comment_id=c.comment_id,b.set_comment_cookie(c.post,comment_id,function(b){a.post(simple_comment_editing.ajax_url,{action:"sce_epoch2_get_comment",comment_id:b,_ajax_nonce:simple_comment_editing.nonce},function(c){a("#comment-"+b).find("p").parent().html(c),a("#comment-"+b).find(".sce-edit-button").simplecommentediting()})})})});function SCE_comment_scroll(){var a=""+window.location,b=/(#[^-]*\-[^&]*)/;if(b.test(a)&&(a=jQuery(""+window.location.hash),0<a.length)){var c=a.offset().top;jQuery("html,body").animate({scrollTop:c},1)}}function SCE_comments_updated(a){var b=a.match(/comment-(\d+)/);if(b){var c=b[1];jQuery("#comment-"+c).find(".sce-edit-button").simplecommentediting()}}
//# sourceMappingURL=simple-comment-editing.min.js.map
