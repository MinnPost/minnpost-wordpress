var tribe_events_bar_action;!function(e,a,t,r,i,s,n,b,l){t(a).ready(function(){function o(e){if(!e.parents(".tribe-bar-disabled").length){var a=e.width();a>800?e.removeClass("tribe-bar-mini tribe-bar-collapse").addClass("tribe-bar-full"):e.removeClass("tribe-bar-full").addClass("tribe-bar-mini"),a<728?(e.removeClass("tribe-bar-mini").addClass("tribe-bar-collapse"),m(t("#tribe-bar-collapse-toggle"))):(e.removeClass("tribe-bar-collapse"),u(t("#tribe-bar-collapse-toggle")))}}function d(){return D.find("li[data-view="+C.find(":selected").data("view")+"]")}function v(){var e=d();D.slideDown("fast").attr("aria-activedescendant",e.attr("id")).focus(),h.addClass("tribe-bar-views-open"),B.attr("aria-expanded","true")}function c(){var e=d();B.removeAttr("aria-expanded"),h.removeClass("tribe-bar-views-open"),D.slideUp("fast").removeAttr("aria-activedescendant").find(".tribe-bar-views-option").removeClass("tribe-bar-active"),e.addClass("tribe-bar-active")}function p(e,a){e.preventDefault();var r=t(a);return r.data("view")===B.data("view")?(B.focus(),void c()):(B.html(r.html()).focus(),c(),n.cur_url=t("option[data-view="+r.data("view")+"]").val(),n.view_target=t('select[name=tribe-bar-view] option[value="'+n.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",void f())}function u(e){var a=e.attr("data-label-shown");e.attr("aria-expanded","true"),e.find(".tribe-bar-toggle-text").html(a),e.addClass("tribe-bar-filters-open"),t(".tribe-bar-filters").slideDown("fast").attr("aria-hidden","false")}function m(e){var a=e.attr("data-label-hidden");t(".tribe-bar-filters").slideUp("fast").attr("aria-hidden","true"),e.removeClass("tribe-bar-filters-open"),e.find(".tribe-bar-toggle-text").html(a),e.attr("aria-expanded","false")}function f(){if(tribe_events_bar_action="change_view","month"===n.view&&g.length){var l=g.val(),o=s.get_day();"0"!=n.datepicker_format?(l=tribeDateFormat(g.bootstrapDatepicker("getDate"),"tribeMonthQuery"),g.val(l+o)):7===l.length&&g.val(l+o)}n.url_params={},t(i).trigger("tribe_ev_preCollectBarParams"),t(i).trigger("pre-collect-bar-params.tribe");var d=t(a.getElementById("tribe-bar-form")).add(a.getElementById("tribe_events_filters_wrapper")),v=d.find("input, select");v.each(function(){var e=t(this);e.val()&&e.val().length&&!e.hasClass("tribe-no-param")&&("month"!==n.view&&"0"!==n.datepicker_format&&e.is(g)?n.url_params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery"):e.is(":checkbox")?e.is(":checked")&&("undefined"==typeof n.url_params[e.attr("name")]&&(n.url_params[e.attr("name")]=[]),n.url_params[e.attr("name")].push(e.val())):"radio"===e.attr("type")?e.is(":checked")&&(n.url_params[e.attr("name")]=e.val()):"undefined"!=typeof e.attr("name")&&(n.url_params[e.attr("name")]=e.val()))});var c=t(".tribe-bar-views-option-"+r.default_mobile_view).data("redirected");(r.redirected_view||c)&&(n.url_params.tribe_redirected=!0),n.url_params=t.param(n.url_params),t(i).trigger("tribe_ev_postCollectBarParams"),t(i).trigger("post-collect-bar-params.tribe"),n.url_params.length&&(n.cur_url+=b.starting_delim()+n.url_params),e.location.href=n.cur_url}l&&(t().bootstrapDatepicker||tec_debug.warn("TEC Debug: vendor bootstrapDatepicker was not loaded before its dependant file tribe-events-bar.js"),t().placeholder||tec_debug.warn("TEC Debug: vendor placeholder was not loaded before its dependant file tribe-events-bar.js"));var h=t(a.getElementById("tribe-bar-form")),g=t(a.getElementById("tribe-bar-date")),w=(t(a.getElementById("tribe-events")),t(a.getElementById("tribe-events-header"))),_=0,C=t("select[name=tribe-bar-view]");if(w.length&&(_=w.data("startofweek")),o(h),h.resize(function(){o(h)}),!t(".tribe-events-week-grid").length&&"month"!==n.view){var y="yyyy-mm-dd";if("0"!==n.datepicker_format){y=r.datepicker_formats.main[n.datepicker_format];var k=s.get_url_param("tribe-bar-date");k?g.val(tribeDateFormat(k,n.datepicker_format)):"day"===n.view&&0!==g.val().length&&g.val(tribeDateFormat(g.val(),n.datepicker_format))}l&&tec_debug.info('TEC Debug: bootstrapDatepicker was just initialized in "tribe-events-bar.js" on:',g),r.datepicker_opts={weekStart:_,format:y,autoclose:!0},tribe_ev.fn.ensure_datepicker_i18n(),g.bootstrapDatepicker(r.datepicker_opts)}g.blur(function(){""===g.val()&&t(".datepicker.dropdown-menu").is(":hidden")&&b.live_ajax()&&b.pushstate&&(n.date=r.cur_date,r.cur_url=r.base_url,t(i).trigger("tribe_ev_runAjax"),t(i).trigger("run-ajax.tribe"))}),t(".tribe-bar-settings").length&&t(a.getElementById("tribe-events-bar")).addClass("tribe-has-settings"),t("#tribe-events-bar .hasDatepicker").length&&t(a.getElementById("tribe-events-bar")).addClass("tribe-has-datepicker"),t('input[name*="tribe-bar-"]').placeholder(),t('<ul class="tribe-bar-views-list" tabindex="-1" role="listbox" aria-labelledby="tribe-bar-views-label" />').insertAfter(C);var D=t(".tribe-bar-views-list");C.find("option").each(function(e){var a=t(this);displaying=a.data("view");var r="tribe-bar-views-option-"+a.data("view");t("<li></li>",{id:r,"class":"tribe-bar-views-option",role:"option",tabindex:"-1","data-tribe-bar-order":e,"data-view":displaying,"aria-labelledby":"tribe-bar-views-label "+r}).html('<span class="tribe-icon-'+displaying+'" aria-hidden="true" role="none"></span>'+a.text()).appendTo(".tribe-bar-views-list")});var x=d();x.addClass("tribe-bar-active");var B=t("<button>",{id:"tribe-bar-views-toggle","class":"tribe-bar-views-toggle","data-view":x.data("view"),"aria-haspopup":"listbox","aria-labelledby":"tribe-bar-views-label tribe-bar-views-toggle"});B.html(x.html()).insertBefore(D),C.hide(),h.on("click","#tribe-bar-views-toggle",function(e){e.preventDefault(),h.hasClass("tribe-bar-views-open")?c():v()}),h.on("click",".tribe-bar-views-option",function(e){p(e,this)}),t(a).on("keydown",function(e){if((38===e.which||40===e.which)&&h.hasClass("tribe-bar-views-open")){e.preventDefault();var a=e.which,t=null,r=D.find("li.tribe-bar-active");38===a&&r.prev(".tribe-bar-views-option")&&(t=r.prev(".tribe-bar-views-option")),40===a&&r.next(".tribe-bar-views-option")&&(t=r.next(".tribe-bar-views-option")),t.length&&(D.attr("aria-activedescendant",t.attr("id")),r.removeClass("tribe-bar-active"),t.addClass("tribe-bar-active").focus())}}),h.on("keyup",".tribe-bar-views-option",function(e){13===e.which&&h.hasClass("tribe-bar-views-open")&&p(e,this)}),h.on("change",".tribe-bar-views-select",function(e){e.preventDefault();var a=t("option:selected",this),r=a.data("view");n.cur_url=t("option[data-view="+r+"]").val(),n.view_target=t('select[name=tribe-bar-view] option[value="'+n.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",f()}),s.maybe_default_view_change(),h.on("click","#tribe-bar-collapse-toggle",function(e){e.preventDefault();var a=t(this);a.hasClass("tribe-bar-filters-open")?m(a):u(a)}),t(a).on("keyup",function(e){if(9===e.which){var r=t("#tribe-bar-collapse-toggle");h.hasClass("tribe-bar-collapse")&&r.hasClass("tribe-bar-filters-open")&&!t.contains(a.getElementById("tribe-bar-filters-wrap"),e.target)&&m(r);var i=t("#tribe-bar-views-toggle");h.hasClass("tribe-bar-views-open")&&i.not(":focus")&&c()}}),t(a).on("keyup",function(e){if(27===e.which){var a=t("#tribe-bar-collapse-toggle");h.hasClass("tribe-bar-collapse")&&a.hasClass("tribe-bar-filters-open")&&(m(a),a.focus());var r=t("#tribe-bar-views-toggle");h.hasClass("tribe-bar-views-open")&&(c(),r.focus())}}),t(i).on("tribe_ev_serializeBar",function(){var e=t("#tribe-bar-collapse-toggle");h.hasClass("tribe-bar-collapse")&&e.hasClass("tribe-bar-filters-open")&&(m(e),e.focus()),t("form#tribe-bar-form input, form#tribe-bar-form select, #tribeHideRecurrence").each(function(){var e=t(this);if(e.is("#tribe-bar-date")){var a=e.val();a.length?"month"===n.view?(n.params[e.attr("name")]=tribeDateFormat(n.mdate,"tribeMonthQuery"),n.url_params[e.attr("name")]=tribeDateFormat(n.mdate,"tribeMonthQuery")):a.match(/[0-9]{4}-[0-9]{2}/)?n.params[e.attr("name")]=n.url_params[e.attr("name")]=a:(n.params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery"),n.url_params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery")):e.is(".placeholder")&&e.is(".bd-updated")?n.url_params[e.attr("name")]=e.attr("data-oldDate"):n.date=r.cur_date}!e.val().length||e.hasClass("tribe-no-param")||e.is("#tribe-bar-date")||(e.is(":checkbox")?e.is(":checked")&&(n.params[e.attr("name")]=e.val(),"map"!==n.view&&(n.url_params[e.attr("name")]=e.val()),("month"===n.view||"day"===n.view||"week"===n.view||n.recurrence)&&n.pushcount++):(n.params[e.attr("name")]=e.val(),"map"!==n.view&&(n.url_params[e.attr("name")]=e.val()),"month"!==n.view&&"day"!==n.view&&"week"!==n.view||n.pushcount++))})});var E=t('#tribe-events-bar [class^="tribe-bar-button-"]'),I=E.next(".tribe-bar-drop-content");E.click(function(){var e=t(this);return e.toggleClass("open"),e.next(".tribe-bar-drop-content").toggle(),!1}),t(a).click(function(e){h.hasClass("tribe-bar-views-open")&&!t.contains(a.getElementById("tribe-bar-views"),e.target)&&(c(),B.focus());var r=t("#tribe-bar-collapse-toggle");h.hasClass("tribe-bar-collapse")&&r.hasClass("tribe-bar-filters-open")&&!t.contains(a.getElementById("tribe-bar-filters-wrap"),e.target)&&(m(r),r.focus()),E.hasClass("open")&&(E.removeClass("open"),I.hide())}),I.click(function(e){e.stopPropagation()}),l&&tec_debug.info("TEC Debug: tribe-events-bar.js successfully loaded")})}(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);