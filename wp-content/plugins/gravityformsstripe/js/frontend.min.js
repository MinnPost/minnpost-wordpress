window.GFStripe=null,function(a){GFStripe=function(b){for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c]);this.form=null,this.init=function(){if(this.isCreditCardOnPage()){var b=this;Stripe.setPublishableKey(this.apiKey),a("#gform_"+this.formId).submit(function(c){if(!a(this).data("gfstripesubmitting")&&1!=a("#gform_save_"+b.formId).val()&&b.isLastPage()){c.preventDefault(),a(this).data("gfstripesubmitting",!0),b.maybeAddSpinner();var d=a(this),e="input_"+b.formId+"_"+b.ccFieldId+"_",f={number:d.find("#"+e+"1").val(),exp_month:d.find("#"+e+"2_month").val(),exp_year:d.find("#"+e+"2_year").val(),cvc:d.find("#"+e+"3").val(),name:d.find("#"+e+"5").val()};b.form=d,Stripe.card.createToken(f,function(a,c){b.responseHandler(a,c)})}})}},this.responseHandler=function(b,c){for(var d=this.form,e="input_"+this.formId+"_"+this.ccFieldId+"_",f=["1","2_month","2_year","3","5"],g=0;g<f.length;g++){var h=d.find("#"+e+f[g]);if("1"==f[g]){var i=a.trim(h.val()),j=gformFindCardType(i);void 0!==this.cardLabels[j]&&(j=this.cardLabels[j]),d.append(a('<input type="hidden" name="stripe_credit_card_last_four" />').val(i.slice(-4))),d.append(a('<input type="hidden" name="stripe_credit_card_type" />').val(j))}}d.append(a('<input type="hidden" name="stripe_response" />').val(a.toJSON(c))),d.submit()},this.isLastPage=function(){var b=a("#gform_target_page_number_"+this.formId);return!(b.length>0)||0==b.val()},this.isCreditCardOnPage=function(){var a=this.getCurrentPageNumber();return!this.ccPage||!a||this.ccPage==a},this.getCurrentPageNumber=function(){var b=a("#gform_source_page_number_"+this.formId);return b.length>0&&b.val()},this.maybeAddSpinner=function(){if(!this.isAjax)if("function"==typeof gformAddSpinner)gformAddSpinner(this.formId);else{var a=this.formId;if(0==jQuery("#gform_ajax_spinner_"+a).length){var b=gform.applyFilters("gform_spinner_url",gf_global.spinnerUrl,a),c=gform.applyFilters("gform_spinner_target_elem",jQuery("#gform_submit_button_"+a+", #gform_wrapper_"+a+" .gform_next_button, #gform_send_resume_link_button_"+a),a);c.after('<img id="gform_ajax_spinner_'+a+'"  class="gform_ajax_spinner" src="'+b+'" alt="" />')}}},this.init()}}(jQuery);