/*! media-credit media-credit-image-properties.js 2017-02-24 5:27:35 PM */
!function(a,b,c){var d,e,f=window.$mediaCredit||{};b.media.events&&(d=b.Backbone.View.extend({className:"advanced-media-credit",template:b.media.template("media-credit-image-properties"),initialize:function(){b.Backbone.View.prototype.initialize.apply(this,arguments)},prepare:function(){return this.model.toJSON()},render:function(){return b.Backbone.View.prototype.render.apply(this,arguments),this}}),b.media.events.on("editor:frame-create",function(a){e=a.frame,e.on("content:render:image-details",function(a){var b=new d({model:a.model});a.on("post-render",function(){a.views.insert(a.$el.find(".advanced-settings"),b.render().el,{at:1}),f.autoComplete(b,'input[data-setting="mediaCreditText"]',!1)})})}),b.media.events.on("editor:image-edit",function(a){""===a.metadata.mediaCreditText&&""!==a.metadata.mediaCreditAuthorID&&(a.metadata.mediaCreditText=f.id[a.metadata.mediaCreditAuthorID])}),b.media.events.on("editor:image-update",function(a){var b,c,d,g=a.editor,h=g.dom,i=a.image,j=e.content.get().model,k=j.get("align"),l=j.get("width"),m=j.get("mediaCreditText"),n=j.get("mediaCreditAuthorID"),o=j.get("mediaCreditLink"),p=j.get("mediaCreditNoFollow");c=i.parentNode&&"A"===i.parentNode.nodeName?h.getNext(i.parentNode,".mceMediaCreditTemp"):h.getNext(i,".mceMediaCreditTemp"),f.id[n]!==m&&(n=""),b=n?f.id[n]+f.separator+f.organization:m,b=b.replace(/<[^>]+>(.*)<\/[^>]+>/g,"$1"),k="align"+(k||"none"),null===c&&(m||n)&&(c=h.create("span",{class:"mceMediaCreditTemp mceNonEditable","data-media-credit-author-id":n,"data-media-credit-text":m,"data-media-credit-align":k,"data-media-credit-link":o,"data-media-credit-nofollow":p},b),i.parentNode&&"A"===i.parentNode.nodeName?h.insertAfter(c,i.parentNode):h.insertAfter(c,i)),c&&(h.getParent(c,"dl.wp-caption")||(d=h.create("div",{class:"mceMediaCreditOuterTemp "+k,style:"width: "+(parseInt(l)+10)+"px"}),h.insertAfter(d,c.parentNode),h.add(d,c.parentNode),h.remove(c.parentNode,!0)),h.setAttrib(c,"data-media-credit-text",m),h.setAttrib(c,"data-media-credit-author-id",n),h.setAttrib(c,"data-media-credit-link",o),h.setAttrib(c,"data-media-credit-nofollow",p),h.setHTML(c,b))}))}(jQuery,wp,_);