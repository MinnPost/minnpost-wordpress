/*! media-credit media-credit-tinymce.js 2018-02-21 1:07:53 AM */

tinymce.PluginManager.add("mediacredit",function(e){"use strict";var t,a,n,i,r,d=tinymce.each,o=tinymce.trim,c=tinymce.Env.iOS;function l(t){return!(!e.dom.getAttrib(t,"data-mce-placeholder")&&!e.dom.getAttrib(t,"data-mce-object"))}function m(t){var a=e.$(t).parents("[contenteditable]");return a&&"false"===a.attr("contenteditable")}function s(t){return p(t.replace(/(?:<p>)?\[(?:wp_)?caption([^\]]+)\]([\s\S]+?)\[\/(?:wp_)?caption\](?:<\/p>)?/g,function(t,a,n){var i,r,d,c,l,m;return(i=a.match(/id=['"]([^'"]*)['"] ?/))&&(a=a.replace(i[0],"")),(r=a.match(/align=['"]([^'"]*)['"] ?/))&&(a=a.replace(r[0],"")),(d=a.match(/class=['"]([^'"]*)['"] ?/))&&(a=a.replace(d[0],"")),(m=a.match(/width=['"]([0-9]*)['"] ?/))&&(a=a.replace(m[0],"")),(l=null!==(l=(n=o(n)).match(/((?:\[media-credit[^\]]+\]\s*)(?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?(?:\s*\[\/media-credit\])?)([\s\S]*)/i))?l:n.match(/((?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?)([\s\S]*)/i))&&l[2]?(c=o(l[2]),l=o(l[1])):(c=o(a).replace(/caption=['"]/,"").replace(/['"]$/,""),l=n),l=p(l),i=i&&i[1]?i[1].replace(/[<>&]+/g,""):"",r=r&&r[1]?r[1]:"alignnone",d=d&&d[1]?" "+d[1].replace(/[<>&]+/g,""):"",!m&&l&&(m=l.match(/width=['"]([0-9]*)['"]/)),m&&m[1]&&(m=m[1]),m&&c?(m=parseInt(m,10),e.getParam("wpeditimage_html5_captions")||(m+=10),'<div class="mceTemp"><dl id="'+i+'" class="wp-caption '+r+d+'" style="width: '+m+'px"><dt class="wp-caption-dt">'+l+'</dt><dd class="wp-caption-dd">'+c+"</dd></dl></div>"):n}),!0)}function p(t,a){var n;return n=(a=void 0!==a&&a)?/(?:<p>)?\[media-credit([^\]]+)\]([\s\S]+?)\[\/media-credit\](?:<\/p>)?/g:/\[media-credit([^\]]+)\]([\s\S]+?)\[\/media-credit\]/g,t.replace(n,function(t,n,i){var r,d,o,c,l,m,s,p,g,u,h=tinymce.trim;return(r=n.match(/id=['"]?([0-9]+)['"]? ?/))&&(n=n.replace(r[0],"")),(d=n.match(/align=['"]([^'"]*)['"] ?/))&&(n=n.replace(d[0],"")),(o=n.match(/width=['"]([0-9]*)['"] ?/))&&(n=n.replace(o[0],"")),(s=n.match(/link=['"]([^'"]*)['"] ?/))&&(n=n.replace(s[0],"")),(u=n.match(/nofollow=['"]([^'"]*)['"] ?/))&&(n=n.replace(u[0],"")),(p=n.match(/name=[']([^']*)['] ?/i))||(p=n.match(/name=["]([^"]*)["] ?/i)),p&&(n=n.replace(p[0],"")),(c=(i=h(i)).match(/((?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?)([\s\S]*)/i))&&c[1]&&(c=h(c[1])),r=r&&r[1]?r[1]:"",d=d&&d[1]?d[1]:"alignnone",s=s&&s[1]?s[1]:"",p=p&&p[1]?p[1]:"",u=u&&u[1]?u[1]:"",!o&&c&&(o=c.match(/width=['"]([0-9]*)['"]/)),o&&o[1]&&(o=o[1]),o&&(p||r)?(l=parseInt(o,10),e.getParam("wpeditimage_html5_captions")||(l+=10),g=(g=""+(p||$mediaCredit.id[r]+$mediaCredit.separator+$mediaCredit.organization)).replace(/<[^>]+>(.*)<\/[^>]+>/g,"$1"),m=c+wp.html.string({tag:"span",content:g,attrs:{class:"mceMediaCreditTemp mceNonEditable","data-media-credit-author-id":r,"data-media-credit-text":_.escape(p),"data-media-credit-align":d,"data-media-credit-link":_.escape(s),"data-media-credit-nofollow":_.escape(u)}}),a&&(m=wp.html.string({tag:"div",content:m,attrs:{class:"mceMediaCreditOuterTemp "+d,style:"width: "+l+"px"}})),m):i})}function g(e){return u(e.replace(/(?:<div [^>]+mceTemp[^>]+>)?\s*(<dl [^>]+wp-caption[^>]+>[\s\S]+?<\/dl>)\s*(?:<\/div>)?/g,function(e,t){var a="";return-1===t.indexOf("<img ")||-1!==t.indexOf("</p>")?t.replace(/<d[ldt]( [^>]+)?>/g,"").replace(/<\/d[ldt]>/g,""):(-1===(a=t.replace(/\s*<dl ([^>]+)>\s*<dt [^>]+>([\s\S]+?)<\/dt>\s*<dd [^>]+>([\s\S]*?)<\/dd>\s*<\/dl>\s*/gi,function(e,t,a,n){var i,r,d,o;return o=(o=a.match(/width="([0-9]*)"/))&&o[1]?o[1]:"",d=(r=(r=t.match(/class="([^"]*)"/))&&r[1]?r[1]:"").match(/align[a-z]+/i)||"alignnone",o&&n?(i=(i=t.match(/id="([^"]*)"/))&&i[1]?i[1]:"",(r=r.replace(/wp-caption ?|align[a-z]+ ?/gi,""))&&(r=' class="'+r+'"'),n=(n=n.replace(/\r\n|\r/g,"\n").replace(/<[a-zA-Z0-9]+( [^<>]+)?>/g,function(e){return e.replace(/[\r\n\t]+/," ")})).replace(/\s*\n\s*/g,"<br />"),'[caption id="'+i+'" align="'+d+'" width="'+o+'"'+r+"]"+(a=u(a))+" "+n+"[/caption]"):("alignnone"!==d[0]&&(a=a.replace(/><img/,' class="'+d[0]+'"><img')),a)})).indexOf("[caption")&&(a=t.breplace(/[\s\S]*?((?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?)(<p>[\s\S]*<\/p>)?[\s\S]*/gi,"<p>$1</p>$2")),a)}),!0)}function u(e,t){var a=/((?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?)<span class="mceMediaCreditTemp[^"]*" ([^>]*)>([\s\S]+?)<\/span>/g;return(t=void 0!==t&&t)&&(a=/<div class="mceMediaCreditOuterTemp[^"]*"[^>]*>((?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?)<span class="mceMediaCreditTemp[^"]*" ([^>]*)>([\s\S]+?)<\/span><\/div>/g),e.replace(a,function(e,t,a,n){var i,r,d,o,c,l,m,s,p="";return-1===t.indexOf("<img ")?"<p>"+n+"</p>":(d=(d=t.match(/width="([0-9]*)"/))&&d[1]?d[1]:"",i=h(a,"data-media-credit-author-id","[0-9]+",!0),o=h(a,"data-media-credit-align","[^'\"]*",!1),r=_.unescape(h(a,"data-media-credit-text",'[^"]*',!1)),c=_.unescape(h(a,"data-media-credit-link",'[^"]*',!1)),l=_.unescape(h(a,"data-media-credit-nofollow",'[^"]*',!1)),d&&(r||i)?(m=r.indexOf('"')>-1?"name='"+r+"'":'name="'+r+'"',s=i?"id="+i:m,c&&(s+=' link="'+c+'"'),l&&"true"===l&&(s+=' nofollow="true"'),0!==(p="[media-credit "+s+' align="'+o+'" width="'+d+'"]'+t+"[/media-credit]").indexOf("[media-credit")&&(p=t.replace(/[\s\S]*?((?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?)(<p>[\s\S]*<\/p>)?[\s\S]*/gi,"<p>$1</p>$2")),p):t)})}function h(e,t,a,n){var i,r=null;return(n=void 0!==n&&n)&&(i=new RegExp(t+"=("+a+") ?"),r=e.match(i)),r||(i=new RegExp(t+'="('+a+')" ?'),r=e.match(i)),r||(i=new RegExp(t+"='("+a+")' ?"),r=e.match(i)),r=r&&r[1]?r[1]:""}function f(e){return e&&!!(e.textContent||e.innerText).replace(/\ufeff/g,"")}function w(t){var a=e.dom.getParent(t,"div.mceTemp")||e.dom.getParent(t,"div.mceMediaCreditOuterTemp");a||"IMG"!==t.nodeName||(a=e.dom.getParent(t,"a")),a?(a.nextSibling?e.selection.select(a.nextSibling):a.previousSibling?e.selection.select(a.previousSibling):e.selection.select(a.parentNode),e.selection.collapse(!0),e.dom.remove(a)):e.dom.remove(t),e.nodeChanged(),e.undoManager.add()}return e.addButton("wp_img_remove",{tooltip:"Remove",icon:"dashicon dashicons-no",onclick:function(){w(e.selection.getNode())}}),e.addButton("wp_img_edit",{tooltip:"Edit|button",icon:"dashicon dashicons-edit",onclick:function(){!function(t){var n,i,r;if("undefined"==typeof wp||!wp.media)return void e.execCommand("mceImage");r=function(t){var a,n,i,r,d,o,c,l,m,s=[],p=e.dom,g=/^\d+$/;(i={attachment_id:!1,size:"custom",caption:"",align:"none",extraClasses:"",link:!1,linkUrl:"",linkClassName:"",linkTargetBlank:!1,linkRel:"",title:"",mediaCreditText:"",mediaCreditAuthorID:"",mediaCreditLink:"",mediaCreditNoFollow:""}).url=p.getAttrib(t,"src"),i.alt=p.getAttrib(t,"alt"),i.title=p.getAttrib(t,"title"),c=p.getAttrib(t,"width"),l=p.getAttrib(t,"height"),(!g.test(c)||parseInt(c,10)<1)&&(c=t.naturalWidth||t.width);(!g.test(l)||parseInt(l,10)<1)&&(l=t.naturalHeight||t.height);i.customWidth=i.width=c,i.customHeight=i.height=l,a=tinymce.explode(t.className," "),n=[],tinymce.each(a,function(e){/^wp-image/.test(e)?i.attachment_id=parseInt(e.replace("wp-image-",""),10):/^align/.test(e)?i.align=e.replace("align",""):/^size/.test(e)?i.size=e.replace("size-",""):n.push(e)}),i.extraClasses=n.join(" "),i.captionClassName=s.join(" "),(r=p.getParents(t,".wp-caption")).length&&(r=r[0],a=r.className.split(" "),tinymce.each(a,function(e){/^align/.test(e)?i.align=e.replace("align",""):e&&"wp-caption"!==e&&s.push(e)}),(d=p.select("dd.wp-caption-dd",r)).length&&(d=d[0],i.caption=e.serializer.serialize(d).replace(/<br[^>]*>/g,"$&\n").replace(/^<p>/,"").replace(/<\/p>$/,"")));t.parentNode&&"A"===t.parentNode.nodeName&&(o=t.parentNode,i.linkUrl=p.getAttrib(o,"href"),i.linkTargetBlank="_blank"===p.getAttrib(o,"target"),i.linkRel=p.getAttrib(o,"rel"),i.linkClassName=o.className);m=o?p.getNext(o,".mceMediaCreditTemp"):p.getNext(t,".mceMediaCreditTemp");m&&(i.align=i.align&&"none"!==i.align?i.align:p.getAttrib(m,"data-media-credit-align","").replace("align",""),i.mediaCreditText=p.getAttrib(m,"data-media-credit-text",""),i.mediaCreditAuthorID=p.getAttrib(m,"data-media-credit-author-id",""),i.mediaCreditLink=p.getAttrib(m,"data-media-credit-link",""),i.mediaCreditNoFollow=p.getAttrib(m,"data-media-credit-nofollow",""));return i}(t),wp.media.events.trigger("editor:image-edit",{editor:e,metadata:r,image:t}),n=wp.media({frame:"image",state:"image-details",metadata:r}),wp.media.events.trigger("editor:frame-create",{frame:n}),i=function(i){e.focus(),e.undoManager.transact(function(){!function(t,n){var i,r,d,o,c,l,m,s,p,g,u,h,w,v,C,N,b,_,T,x,A,M,P=e.dom;(i=tinymce.explode(n.extraClasses," "))||(i=[]);d=t.parentNode&&"A"===t.parentNode.nodeName&&!f(t.parentNode)?t.parentNode:t;b=P.getNext(d,".mceMediaCreditTemp"),n.caption||(b?P.setAttrib(b,"data-media-credit-align","align"+n.align):i.push("align"+n.align));n.attachment_id&&(i.push("wp-image-"+n.attachment_id),n.size&&"custom"!==n.size&&i.push("size-"+n.size));v=n.width,C=n.height,"custom"===n.size&&(v=n.customWidth,C=n.customHeight);h={src:n.url,width:v||null,height:C||null,title:n.title||null,class:i.join(" ")||null},P.setAttribs(t,h),e.$(t).attr("alt",n.alt||""),w={href:n.linkUrl,rel:n.linkRel||null,target:n.linkTargetBlank?"_blank":null,class:n.linkClassName||null},t.parentNode&&"A"===t.parentNode.nodeName&&!f(t.parentNode)?n.linkUrl?P.setAttribs(t.parentNode,w):P.remove(t.parentNode,!0):n.linkUrl&&((m=P.getParent(t,"a"))&&P.insertAfter(t,m),m=P.create("a",w),t.parentNode.insertBefore(m,t),m.appendChild(t));s=e.dom.getParent(t,".mceTemp"),v=parseInt(v,10),e.getParam("wpeditimage_html5_captions")||(v+=10);n.caption?(n.caption=function(t){if(!t||-1===t.indexOf("<")&&-1===t.indexOf(">"))return t;a||(a=new tinymce.html.Serializer({},e.schema));return a.serialize(e.parser.parse(t,{forced_root_block:!1}))}(n.caption),u=n.attachment_id?"attachment_"+n.attachment_id:null,N="align"+(n.align||"none"),r="wp-caption "+N,n.captionClassName&&(r+=" "+n.captionClassName.replace(/[<>&]+/g,"")),b&&P.setAttrib(b,"data-media-credit-align",N),s?((g=P.select("dl.wp-caption",s)).length&&P.setAttribs(g,{id:u,class:r,style:"width: "+v+"px"}),(p=P.select(".wp-caption-dd",s)).length&&P.setHTML(p[0],n.caption)):(o="<dl "+(u=u?'id="'+u+'" ':"")+'class="'+r+'" style="width: '+v+'px"><dt class="wp-caption-dt"></dt><dd class="wp-caption-dd">'+n.caption+"</dd></dl>",l=P.create("div",{class:"mceTemp"},o),(c=P.getParent(d,"p"))||(c=P.getParent(d,".mceMediaCreditOuterTemp"))?(c.parentNode.insertBefore(l,c),P.remove(d),b&&P.remove(b)):d.parentNode.insertBefore(l,d),d=e.$(l).find("dt.wp-caption-dt").append(d),c&&P.isEmpty(c)&&P.remove(c),b&&d.append(b))):(T=!n.mediaCreditText&&!n.mediaCreditAuthorID,s?((b=P.getNext(d,".mceMediaCreditTemp"))&&!T?(N="align"+(n.align||"none"),c=P.create("div",{class:"mceMediaCreditOuterTemp "+N,style:"width: "+v+"px"})):c=P.create("p"),s.parentNode.insertBefore(c,s),c.appendChild(d),b&&!T&&c.appendChild(b),P.remove(s)):(_=P.getParent(b,".mceMediaCreditOuterTemp"))&&(T?(c=P.create("p"),_.parentNode.insertBefore(c,_),c.appendChild(d),P.remove(_)):(N="align"+(n.align||"none"),_.className=_.className.replace(/ ?align(left|center|right|none)/g," ")+N,P.setAttrib(_,"style","width: "+v+"px"))),x=e.$(t),A=x.attr("srcset"),M=x.attr("src"),A&&M&&(M=M.replace(/[?#].*/,""),-1===A.indexOf(M)&&x.attr("srcset",null).attr("sizes",null)));wp.media.events&&wp.media.events.trigger("editor:image-update",{editor:e,metadata:n,image:t});e.nodeChanged()}(t,i)}),n.detach()},n.state("image-details").on("update",i),n.state("replace-image").on("replace",i),n.on("close",function(){e.focus(),n.detach()}),n.open()}(e.selection.getNode())}}),d({alignleft:"Align left",aligncenter:"Align center",alignright:"Align right",alignnone:"No alignment"},function(t,a){var n=a.slice(5);e.addButton("wp_img_"+a,{tooltip:t,icon:"dashicon dashicons-align-"+n,cmd:"alignnone"===a?"wpAlignNone":"Justify"+n.slice(0,1).toUpperCase()+n.slice(1),onPostRender:function(){var t=this;e.on("NodeChange",function(n){var i;"IMG"===n.element.nodeName&&(i=e.dom.getParent(n.element,".wp-caption")||n.element,"alignnone"===a?t.active(!/\balign(left|center|right)\b/.test(i.className)):t.active(e.dom.hasClass(i,a)))})}})}),e.once("preinit",function(){e.wp&&e.wp._createToolbar&&(t=e.wp._createToolbar(["wp_img_alignleft","wp_img_aligncenter","wp_img_alignright","wp_img_alignnone","wp_img_edit","wp_img_remove"]))}),e.on("wptoolbar",function(e){"IMG"!==e.element.nodeName||l(e.element)||(e.toolbar=t)}),c&&e.on("init",function(){e.on("touchstart",function(e){"IMG"!==e.target.nodeName||m(e.target)||(n=!0)}),e.dom.bind(e.getDoc(),"touchmove",function(){n=!1}),e.on("touchend",function(a){var i;n&&"IMG"===a.target.nodeName&&!m(a.target)?(i=a.target,n=!1,window.setTimeout(function(){e.selection.select(i),e.nodeChanged()},100)):t&&t.hide()})}),e.on("init",function(){var t=e.dom,a=e.getParam("wpeditimage_html5_captions")?"html5-captions":"html4-captions";t.addClass(e.getBody(),a),tinymce.Env.ie&&tinymce.Env.ie>10&&t.bind(e.getBody(),"mscontrolselect",function(a){"IMG"===a.target.nodeName&&t.getParent(a.target,".wp-caption")?e.getBody().focus():"DL"===a.target.nodeName&&t.hasClass(a.target,"wp-caption")&&a.target.focus()})}),e.on("ObjectResized",function(t){"IMG"===t.target.nodeName&&e.undoManager.transact(function(){var a,n,i=t.target,r=e.dom;"IMG"===i.nodeName&&(i.className=i.className.replace(/\bsize-[^ ]+/,""),(a=r.getParent(i,".wp-caption"))&&(n=t.width||r.getAttrib(i,"width"))&&(n=parseInt(n,10),e.getParam("wpeditimage_html5_captions")||(n+=10),r.setStyle(a,"width",n+"px")))})}),e.on("pastePostProcess",function(t){e.dom.getParent(e.selection.getNode(),"dd.wp-caption-dd")&&(e.$("img, audio, video, object, embed, iframe, script, style",t.node).remove(),e.$("*",t.node).each(function(t,a){e.dom.isBlock(a)&&(tinymce.trim(a.textContent||a.innerText)?(e.dom.insertAfter(e.dom.create("br"),a),e.dom.remove(a,!0)):e.dom.remove(a))}),e.$("br",t.node).each(function(t,a){a.nextSibling&&"BR"!==a.nextSibling.nodeName&&a.previousSibling&&"BR"!==a.previousSibling.nodeName||e.dom.remove(a)}),i=!0)}),e.on("BeforeExecCommand",function(a){var n,r,d,c,l,m,s,p,g=a.command,u=e.dom;if("mceInsertContent"===g||"Indent"===g||"Outdent"===g){if(n=e.selection.getNode(),m=u.getParent(n,"div.mceTemp")||u.getParent(n,"div.mceMediaCreditOuterTemp")){if("mceInsertContent"!==g)return a.preventDefault(),a.stopImmediatePropagation(),!1;if(i)return void(i=!1);r=u.create("p"),u.insertAfter(r,m),e.selection.setCursorLocation(r,0),"IMG"===n.nodeName&&e.$(m).remove(),e.nodeChanged()}}else if("JustifyLeft"===g||"JustifyRight"===g||"JustifyCenter"===g||"wpAlignNone"===g){if(n=e.selection.getNode(),c="align"+g.slice(7).toLowerCase(),d=e.dom.getParent(n,".wp-caption"),"IMG"!==n.nodeName&&!d)return;n=d||n,s=u.getNext(u.getParent(n,"a"),".mceMediaCreditTemp")||u.select(".mceMediaCreditTemp",n),l=e.dom.hasClass(n,c)?" alignnone":" "+c,n.className=o(n.className.replace(/ ?align(left|center|right|none)/g,"")+l),s&&(u.setAttrib(s,"data-media-credit-align",c),(p=u.getParent(s,"div.mceMediaCreditOuterTemp"))&&(p.className=o(p.className.replace(/ ?align(left|center|right|none)/g,"")+l))),e.nodeChanged(),a.preventDefault(),t&&t.reposition(),e.fire("ExecCommand",{command:g,ui:a.ui,value:a.value})}}),e.on("keydown",function(t){var a,n,i,r,d=e.selection,o=t.keyCode,c=e.dom,l=tinymce.util.VK;if(o===l.ENTER)a=d.getNode(),(n=c.getParent(a,"div.mceTemp"))||(n=c.getParent(a,"div.mceMediaCreditOuterTemp")),n&&(c.events.cancel(t),tinymce.each(c.select("dt, dd",n),function(e){c.isEmpty(e)&&c.remove(e)}),r=tinymce.Env.ie&&tinymce.Env.ie<11?"":'<br data-mce-bogus="1" />',i=c.create("p",null,r),"DD"===a.nodeName?c.insertAfter(i,n):n.parentNode.insertBefore(i,n),e.nodeChanged(),d.setCursorLocation(i,0));else if((o===l.DELETE||o===l.BACKSPACE)&&("DIV"===(a=d.getNode()).nodeName&&(c.hasClass(a,"mceTemp")||c.hasClass(a,"mceMediaCreditOuterTemp"))?n=a:"IMG"!==a.nodeName&&"DT"!==a.nodeName&&"A"!==a.nodeName||(n=c.getParent(a,"div.mceTemp")||c.getParent(a,"div.mceMediaCreditOuterTemp")),n))return c.events.cancel(t),w(a),!1}),e.on("NodeChange",function(t){var a,n,i="",r=!1,d=t.element,o=e.dom;if(a=o.getParent(d,"div.mceTemp")||o.getParent(d,"div.mceMediaCreditOuterTemp"))return"A"===d.nodeName&&0===d.children.length?(i=d.textContent,r=!0):"DIV"===d.nodeName&&o.hasClass(d,"mceMediaCreditOuterTemp")&&1===d.children.length&&o.hasClass(d.firstElementChild,"mceMediaCreditTemp")&&(i=d.firstChild.textContent,r=!0),r?(n=o.create("p",null,i),o.insertAfter(n,a),o.events.cancel(t),o.remove(a),!1):void 0}),tinymce.Env.gecko&&e.on("undo redo",function(){"IMG"===e.selection.getNode().nodeName&&e.selection.collapse()}),e.wpSetImgCaption=function(e){return s(e)},e.wpGetImgCaption=function(e){return g(e)},e.on("beforeGetContent",function(t){"raw"!==t.format&&e.$('img[id="__wp-temp-img-id"]').attr("id",null)}),e.on("BeforeSetContent",function(t){"raw"!==t.format&&(t.content=e.wpSetImgCaption(t.content))}),e.on("PostProcess",function(t){t.get&&(t.content=e.wpGetImgCaption(t.content))}),e.on("dragstart",function(){var t=e.selection.getNode();"IMG"===t.nodeName&&((r=e.dom.getParent(t,".mceTemp"))||"A"!==t.parentNode.nodeName||f(t.parentNode)||(r=t.parentNode))}),e.on("drop",function(t){var a=e.dom,n=tinymce.dom.RangeUtils.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc());n&&a.getParent(n.startContainer,".mceTemp")?t.preventDefault():r&&(t.preventDefault(),e.undoManager.transact(function(){n&&e.selection.setRng(n),e.selection.setNode(r),a.remove(r)})),r=null}),e.wp=e.wp||{},e.wp.isPlaceholder=l,{_do_shcode:s,_get_shcode:g}});